<!DOCTYPE html>
<html>
    <head>
        <title>Etch-A-Sketch</title>
        <link rel='stylesheet' type='text/css' href='style.css'/>
    </head>
    <body>
        <div id='controls'>
            <button id='reset'>Reset</button>
            <button id='new'>New Grid</button>
        </div>
        <div id='sketchWindow'>
            <div id='gridContainer'></div>
        </div>
    </body>
    <script>
        let userNumberSelection = 0;
        generateDivs(chooseNumberOfSquaresPerSide());
        defineGrid();
        let resetButton = document.querySelector('#reset');
        let newButton = document.querySelector('#new');
        resetButton.addEventListener('click', function () {
            resetSketchPad();
        });
        newButton.addEventListener('click', function() {
            destroyDivs();
            generateDivs(chooseNumberOfSquaresPerSide());
            defineGrid();
        });
        function chooseNumberOfSquaresPerSide() {
            userNumberSelection = prompt('How many squares do you want each side to have?');
            numberOfSquaresPerSide = parseInt(userNumberSelection, 10);
            if(isNaN(numberOfSquaresPerSide)) {
                alert('Please enter a numerical value. No letters!');
                generateGrid(chooseNumberOfSquaresPerSide());
            } else {
                numberOfTotalSquares = numberOfSquaresPerSide * numberOfSquaresPerSide;
                return numberOfTotalSquares;
            }
        }
        function generateDivs(numerOfTotalSquares) {
            for (i = 1; i <= numberOfTotalSquares; i++) {
                let gridContainerSelector = document.querySelector('#gridContainer');
                let newDiv = document.createElement('div');
                let divName = "div" + i;
                let newDivContent = document.createElement('p');
                newDivContent.textContent = "";
                newDiv.setAttribute('id', 'div' + i);
                newDiv.appendChild(newDivContent);
                gridContainerSelector.appendChild(newDiv);
                let dynamicOpacity = 0.1;
                newDiv.addEventListener('mouseover', function() {
                document.getElementById(divName).style.background = 'lightgreen';
                dynamicOpacity += 0.1;
                document.getElementById(divName).style.opacity = dynamicOpacity;
                });
            }
        }
        function destroyDivs() {
            for(i = 1; i <= numberOfTotalSquares; i++) {
                let divName = "div" + i;
                let divToBeRemoved = document.getElementById(divName);
                divToBeRemoved.parentNode.removeChild(divToBeRemoved);
            }
        }
        function resetSketchPad() {
            for(i = 1; i <= numberOfTotalSquares; i++) {
                let divName = "div" + i;
                document.getElementById(divName).style.background = '';
            }
        }
        function defineGrid() {
            let x = userNumberSelection;
            let layout = document.getElementById('gridContainer');
            layout.style.display = 'grid';
            layout.style.gridTemplateColumns = 'repeat(' + x + ', 1fr)';
        }
    </script>
</html>